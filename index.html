<html>
    <head>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <style>
            body {
                background: #fff;
                color: #333;
                font: 11px verdana, arial, helvetica, sans-serif;
            }
             #jfmfs-friend-selector a:link, a:visited, a:hover {
                color: #666;
                font-weight: bold;
                text-decoration: none;
            }
             #jfmfs-friend-selector input {
                background-color: #fcfcfc;
                border: 1px solid #ccc;
                font: 11px verdana, arial, helvetica, sans-serif;
                margin: 2px 0;
                padding: 2px 4px;
            }
            #jfmfs-friend-selector .jfmfs-friend {                
                cursor:pointer;
                display:block;
                float:left;
                height:56px;
                margin:3px;
                padding:4px;
                width:126px;
                border: 1px solid #FFFFFF;
                -moz-border-radius: 5px; 
                -webkit-border-radius: 5px;
            }
            
            #jfmfs-friend-selector .jfmfs-friend img {
                border:1px solid #CCCCCC;
                float:left;
                margin:0;
                padding:2px 2px 0;
            }
            
            #jfmfs-friend-selector .jfmfs-friend div {
                color:#111111;
                font-size:11px;
                overflow:hidden;
                padding:2px 0 0 6px;
                width:62px;
            }
            
            #jfmfs-friend-container {
                overflow:scroll;
                overflow-x: hidden;
                -ms-overflow-x: hidden;
                width:100%;
                height:400px;  
            }
            
            #jfmfs-friend-selector {
                width:725px;   
                height:376px;                            
            }
            
            #jfmfs-inner-header {
                background:none repeat scroll 0 0 #F7F7F7;
                border-bottom:1px solid #CCCCCC;
                color:#3B5998;
                font-size:11px;
                font-weight:bold;
                height:25px;
                padding:2px;
            }
            
            #jfmfs-friend-selector .selected {
                background-color: #3B5998;
                border: 1px solid #3B5998;
            }
            
            #jfmfs-friend-selector .selected div {
                color: #FFFFFF;
            }
            
            #jfmfs-friend-selector .hover {
                background-color: #EFF2F7;
            }
            
            #jfmfs-friend-selector .hide-non-selected, 
            #jfmfs-friend-selector .hide-filtered {
                display: none;
            }
            
            div.jfmfs-button {
                background:none repeat scroll 0 0 #6D84B4;
                border:1px solid #3B5998;
                color:white;
                cursor:pointer;
                margin:4px 5px 0 4px;
                padding:2px 5px;
                text-decoration:none;
            }
            
            #jfmfs-inner-header div.jfmfs-button {
                float:right;
            }
            
            #jfmfs-inner-header div.jfmfs-button-hover {
                text-decoration: underline;
            }
            
            #jfmfs-friend-filter-text {
                height: 23px;
            }
            
            #jfmfs-inner-header span.jfmfs-title {
                color: #333333;
                font-weight: bold;
                margin: 3px 0 2px;
            }
        </style>
    </head>
    <body>

        <div id="pageBody">
            <div id="fb-root"></div>
            <script src="http://connect.facebook.net/en_US/all.js"></script>
            <script>
              FB.init({appId: '138240409546605', cookie: true});

              function login() {
                  FB.login(function(response) {
                    if (response.session) {

                        FB.api('/me', function(response) {
                            $("#username").html("<img src='https://graph.facebook.com/" + response.id + "/picture'/><div>" + response.name + "</div>");

                            FB.api('/me/friends', function(response) {
                                $.each(response.data, function(i, friend) {
                                    $("#jfmfs-friend-container").append("<div class='jfmfs-friend' id='" + friend.id  +"'><img src='https://graph.facebook.com/" + friend.id + "/picture' /><div class='friend-name'>" + friend.name + "</div></div>");
                                });
                                $("#friend-count").html(response.data.length);
                                $("#user-status").show();
                                $("#logged-out-status").hide();
                                friends_selector_init();
                            });

                        });
                    } else {
                      alert('Login Failed!');
                    }
                  });
                  
              }

              function friends_selector_init() {
                  $(".jfmfs-friend").live('click', function() {
                    $(this).toggleClass("selected");
                    $("#jfmfs-selected-count").html($(".selected").size());
                    $(this).removeClass("hover");
                  });

                  $("#show-friends").live('click', function() {
                      var ids = [];
                      $.each($(".jfmfs-friend.selected"), function(i, friend) {
                        ids.push($(friend).attr("id"));

                      });

                      $("#selected-friends").html(ids.join(', '));
                  });
                  
                  $("#jfmfs-filter-selected").live('click', function() {
                      $(".jfmfs-friend").not(".selected").addClass("hide-non-selected");
                  });
                  
                  $("#jfmfs-filter-all").live('click', function() {
                      $(".jfmfs-friend").removeClass("hide-non-selected");
                  });
                  
                  $(".jfmfs-friend:not(.selected)").live(
                      'hover', function (ev) {
                          if (ev.type == 'mouseover') {
                              $(this).addClass("hover");
                          }
                          if (ev.type == 'mouseout') {
                              $(this).removeClass("hover");
                          }
                  });                  
                  
                  $("#jfmfs-friend-filter-text")
                      .keyup( function() {
                         var filter = $(this).val();
                         if(filter == '') {
                            $(".jfmfs-friend").removeClass("hide-filtered");
                         }
                         else {
                             $("#jfmfs-friend-selector").find(".friend-name:not(:Contains(" + filter +"))").parent().addClass("hide-filtered");
                             $("#jfmfs-friend-selector").find(".friend-name:Contains(" + filter +")").parent().removeClass("hide-filtered");                         
                         }    
                      })
                    .focus( function() {
                        if($.trim($(this).val()) == 'Start typing a name')
                            $(this).val('');
                    })
                    .blur(function() {
                        if($.trim($(this).val()) == '')
                            $(this).val('Start typing a name');                        
                    });
                  $(".jfmfs-button").hover(
                      function(){ $(this).addClass("jfmfs-button-hover");} , 
                      function(){ $(this).removeClass("jfmfs-button-hover");}
                  );
              }
              
              
              
              jQuery.expr[':'].Contains = function(a, i, m) { 
                return jQuery(a).text().toUpperCase().indexOf(m[3].toUpperCase()) >= 0; 
              };
            </script>

            <div id="logged-out-status" style="">
                <a href="javascript:login()">Login</a>
            </div>
            
            <div id="user-status" style="display:none;">
                <span id="username"></span> has <span id="friend-count"></span>  friends
                <div style="clear:both;"></div>
                <a href="#" id="show-friends">Show Selected Friends</a>
                <div id="selected-friends" style="height:30px"></div>
                <div id="jfmfs-friend-selector">
                    <div id="jfmfs-inner-header">
                        <span class="jfmfs-title">Find Friends: </span><input type="text" id="jfmfs-friend-filter-text"/>
                        <div class="jfmfs-button" id="jfmfs-filter-all">All</div>
                        <div class="jfmfs-button" id="jfmfs-filter-selected">Selected (<span id="jfmfs-selected-count">0</span>)</div>
                    </div>
                    <div id="jfmfs-friend-container"></div>
                </div>
            </div>
        </div>
    </body>
</html>

